<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Travelee Admin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/admin/css/dashboard-style.css}">
</head>
<body>
<div class="dashboard-container">
    <!-- Header -->
    <div th:replace="~{/admin/fragments/header :: header}"></div>

    <!-- Sidebar -->
    <div th:replace="~{/admin/fragments/sidebar :: aside}"></div>
    <!-- Main Content -->
    <main class="main-content">
        <div class="content-header">
            <h1>Dashboard</h1>
            <p>Chào mừng bạn trở lại, Admin!</p>
        </div>

        <div class="dashboard-stats">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-info">
                    <h3>1,234</h3>
                    <p>Tổng người dùng</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-map-marked-alt"></i>
                </div>
                <div class="stat-info">
                    <h3>56</h3>
                    <p>Tours hiện có</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <div class="stat-info">
                    <h3>89</h3>
                    <p>Đặt tour hôm nay</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-star"></i>
                </div>
                <div class="stat-info">
                    <h3>4.8</h3>
                    <p>Đánh giá trung bình</p>
                </div>
            </div>
        </div>

        <!-- Thống kê tour đã đặt trong tháng và tổng tiền thu về -->
        <div class="dashboard-analytics">
            <div class="analytics-header">
                <h2>Thống kê tour đã đặt trong tháng</h2>
                <select id="monthSelect" class="month-select">
                    <option value="1">Tháng 1/2024</option>
                    <option value="2">Tháng 2/2024</option>
                    <option value="3">Tháng 3/2024</option>
                    <option value="4">Tháng 4/2024</option>
                    <option value="5" selected>Tháng 5/2024</option>
                    <option value="6">Tháng 6/2024</option>
                    <option value="7">Tháng 7/2024</option>
                    <option value="8">Tháng 8/2024</option>
                    <option value="9">Tháng 9/2024</option>
                    <option value="10">Tháng 10/2024</option>
                    <option value="11">Tháng 11/2024</option>
                    <option value="12">Tháng 12/2024</option>
                </select>
            </div>
            <div class="analytics-content">
                <div class="analytics-stat">
                    <h3 id="totalTours">320</h3>
                    <p>Tổng số tour đã đặt trong tháng</p>
                </div>
                <div class="analytics-chart">
                    <canvas id="revenueChart" height="120"></canvas>
                    <p class="chart-label">Tổng số tiền thu về từng ngày trong tháng</p>
                </div>
            </div>
        </div>

        <div class="dashboard-content">
            <div class="content-section">
                <h2>Hoạt động gần đây</h2>
                <div class="activity-list">
                    <div class="activity-item">
                        <div class="activity-icon">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <div class="activity-info">
                            <p>Người dùng mới đăng ký: <strong>Nguyễn Văn A</strong></p>
                            <span class="activity-time">2 phút trước</span>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="activity-info">
                            <p>Đặt tour mới: <strong>Tour Hà Nội - Sapa</strong></p>
                            <span class="activity-time">15 phút trước</span>
                        </div>
                    </div>
                    <div class="activity-item">
                        <div class="activity-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="activity-info">
                            <p>Đánh giá mới: <strong>5 sao cho Tour Đà Nẵng</strong></p>
                            <span class="activity-time">1 giờ trước</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <div th:replace="~{/admin/fragments/footer :: footer}"></div>

</div>

<script th:src="@{/admin/js/dashboard-script.js}"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Dữ liệu mẫu cho từng tháng
    const revenueData = {
        5: {
            days: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],
            revenue: [12000000, 15000000, 10000000, 18000000, 9000000, 20000000, 17000000, 16000000, 14000000, 21000000, 18000000, 15000000, 12000000, 13000000, 17000000, 16000000, 18000000, 20000000, 21000000, 22000000, 19000000, 17000000, 16000000, 15000000, 14000000, 13000000, 12000000, 11000000, 10000000, 9000000, 8000000],
            totalTours: 320
        },
        4: {
            days: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],
            revenue: [10000000, 12000000, 9000000, 15000000, 8000000, 17000000, 14000000, 13000000, 12000000, 16000000, 15000000, 12000000, 11000000, 12000000, 14000000, 13000000, 15000000, 16000000, 17000000, 18000000, 15000000, 14000000, 13000000, 12000000, 11000000, 10000000, 9000000, 8000000, 7000000, 6000000],
            totalTours: 270
        }
        // Thêm dữ liệu cho các tháng khác nếu muốn
    };

    const ctx = document.getElementById('revenueChart').getContext('2d');
    let chart;
    function renderChart(month) {
        const data = revenueData[month] || revenueData[5];
        document.getElementById('totalTours').textContent = data.totalTours;
        if (chart) chart.destroy();
        chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: data.days.map(d => `Ngày ${d}`),
                datasets: [{
                    label: 'Doanh thu (VNĐ)',
                    data: data.revenue,
                    backgroundColor: 'rgba(102, 126, 234, 0.7)',
                    borderColor: 'rgba(102, 126, 234, 1)',
                    borderWidth: 1,
                    borderRadius: 6,
                    maxBarThickness: 18
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.dataset.label + ': ' + context.parsed.y.toLocaleString('vi-VN') + ' VNĐ';
                            }
                        }
                    }
                },
                scales: {
                    x: { grid: { display: false } },
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function(value) {
                                return value.toLocaleString('vi-VN') + ' VNĐ';
                            }
                        }
                    }
                }
            }
        });
    }
    document.getElementById('monthSelect').addEventListener('change', function() {
        renderChart(this.value);
    });
    renderChart(5);
</script>
</body>
</html>